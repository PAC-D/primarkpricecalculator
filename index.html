<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carton Price Calculator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
        }
        
        .calculator-container {
            background: white;
            border-radius: 24px;
            box-shadow: 0 25px 70px rgba(0,0,0,0.2);
            padding: 50px;
            max-width: 700px;
            width: 100%;
            margin-top: 40px;
            margin-bottom: 120px;
            border: 1px solid rgba(255,255,255,0.1);
        }
        
        h1 {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 8px;
            text-align: center;
            font-size: 32px;
            font-weight: 700;
            letter-spacing: -0.5px;
        }

        h3 {
            text-align: center;
            color: #64748b;
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 35px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .form-group {
            margin-bottom: 28px;
        }
        
        label {
            display: block;
            margin-bottom: 10px;
            color: #334155;
            font-weight: 600;
            font-size: 14px;
            letter-spacing: 0.3px;
        }
        
        select, input[type="number"] {
            width: 100%;
            padding: 14px 18px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            font-size: 15px;
            transition: all 0.3s ease;
            background: #f8fafc;
            color: #1e293b;
            font-family: inherit;
        }
        
        select:disabled, input[type="number"]:disabled {
            background: #f1f5f9;
            cursor: not-allowed;
            color: #94a3b8;
            border-color: #e2e8f0;
        }
        
        select:focus, input[type="number"]:focus {
            outline: none;
            border-color: #667eea;
            background: white;
            box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.08);
        }
        
        .dimension-group {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 16px;
        }

        .dimension-group > div label {
            font-size: 12px;
            margin-bottom: 6px;
            color: #64748b;
            font-weight: 500;
        }

        .marking-options {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            padding: 20px;
            border-radius: 14px;
            border: 2px solid #fbbf24;
        }

        .marking-label {
            display: flex;
            align-items: center;
            margin-bottom: 12px;
            font-weight: 500;
            cursor: pointer;
            padding: 8px;
            border-radius: 8px;
            transition: background 0.2s;
            color: #78350f;
        }

        .marking-label:hover {
            background: rgba(255,255,255,0.4);
        }

        .marking-label:last-child {
            margin-bottom: 0;
        }

        .marking-label input {
            margin-right: 12px;
            width: 18px;
            height: 18px;
            cursor: pointer;
        }
        
        .calculate-btn {
            width: 100%;
            padding: 18px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 14px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 15px;
            text-transform: uppercase;
            letter-spacing: 1px;
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.3);
        }
        
        .calculate-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 35px rgba(102, 126, 234, 0.4);
        }
        
        .calculate-btn:active {
            transform: translateY(-1px);
        }
        
        .results {
            margin-top: 35px;
            padding: 30px;
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            border-radius: 16px;
            display: none;
            border: 2px solid #bae6fd;
        }
        
        .results.show {
            display: block;
            animation: slideIn 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .result-item {
            display: flex;
            justify-content: space-between;
            padding: 14px 0;
            border-bottom: 1px solid rgba(14, 165, 233, 0.15);
        }
        
        .result-item:last-child {
            border-bottom: none;
        }
        
        .result-label {
            color: #0c4a6e;
            font-weight: 600;
            font-size: 14px;
        }
        
        .result-value {
            color: #0369a1;
            font-weight: 700;
            font-size: 15px;
        }
        
        .custom-message {
            color: #b91c1c;
            font-weight: 700;
            text-align: center;
            width: 100%;
            padding: 18px;
            background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%);
            border-radius: 12px;
            margin-top: 15px;
            border: 2px solid #f87171;
            font-size: 14px;
            letter-spacing: 0.3px;
        }

        #markingPriceRow {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            padding: 14px 18px;
            border-radius: 10px;
            border: 2px solid #fbbf24;
            margin: 8px 0;
        }

        #markingPriceRow .result-label {
            color: #78350f;
        }

        #markingPriceRow .result-value {
            color: #92400e;
        }

        /* Logo Footer */
        .logo-footer {
            position: fixed;
            bottom: 30px;
            left: 0;
            width: 100%;
            padding: 0 50px;
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
            pointer-events: none;
            z-index: 10;
        }

        .logo-footer img {
            height: 70px;
            width: auto;
            pointer-events: auto;
            filter: drop-shadow(0 4px 12px rgba(0,0,0,0.15));
            transition: transform 0.3s ease;
        }

        .logo-footer img:hover {
            transform: scale(1.05);
        }

        /* Responsive */
        @media (max-width: 640px) {
            .calculator-container {
                padding: 30px 25px;
            }

            h1 {
                font-size: 26px;
            }

            .dimension-group {
                grid-template-columns: 1fr;
                gap: 12px;
            }

            .logo-footer {
                padding: 0 25px;
                bottom: 20px;
            }

            .logo-footer img {
                height: 50px;
            }
        }
    </style>
</head>
<body>
    <div class="calculator-container">
        <h1>Carton Price Calculator</h1>
        <h3>Only for Bangladesh (Packaging Supplier Management)</h3>
        
        <div class="form-group">
            <label for="flute">Flute Type</label>
            <select id="flute" onchange="updateCartonStyle()">
                <option value="">Select Flute Type</option>
                <option value="c-flute">C-Flute</option>
                <option value="bc-flute">BC-Flute</option>
            </select>
        </div>
        
        <div class="form-group">
            <label for="cartonStyle">Carton Style</label>
            <select id="cartonStyle" onchange="updateCartonSelection()" disabled>
                <option value="">Select Carton Style</option>
            </select>
        </div>
        
        <div class="form-group">
            <label for="cartonSelection">Carton Selection</label>
            <select id="cartonSelection" onchange="updateDimensions()" disabled>
                <option value="">Select Carton</option>
            </select>
        </div>
        
        <div class="form-group">
            <label>Dimensions (mm)</label>
            <div class="dimension-group">
                <div>
                    <label for="length">Length (L)</label>
                    <input type="number" id="length" placeholder="L" min="0" disabled>
                </div>
                <div>
                    <label for="width">Width (W)</label>
                    <input type="number" id="width" placeholder="W" min="0" disabled>
                </div>
                <div>
                    <label for="height">Height (H)</label>
                    <input type="number" id="height" placeholder="H" min="0" disabled>
                </div>
            </div>
        </div>
        
        <div class="form-group">
            <label for="quantity">Carton Quantity</label>
            <input type="number" id="quantity" placeholder="Enter quantity" min="1" oninput="checkQuantity()">
        </div>

        <div class="form-group" id="markingSection" style="display: none;">
            <label style="color: #b91c1c; font-weight: 700;">Carton Marking (Qty < 100)</label>
            <div class="marking-options">
                <label class="marking-label">
                    <input type="radio" name="marking" value="print" checked> 
                    Carton Print (+ $20.00 Set-up Fee)
                </label>
                <label class="marking-label">
                    <input type="radio" name="marking" value="label"> 
                    Label Print (+ $0.06 per label)
                </label>
                <label class="marking-label">
                    <input type="radio" name="marking" value="none"> 
                    None (Print at own factory)
                </label>
            </div>
        </div>
        
        <button class="calculate-btn" onclick="calculate()">Calculate Price</button>
        
        <div class="results" id="results">
            <div class="result-item" id="sheetLengthRow">
                <span class="result-label">Blank Sheet Length (L):</span>
                <span class="result-value" id="sheetLength">-</span>
            </div>
            <div class="result-item" id="sheetWidthRow">
                <span class="result-label">Blank Sheet Width (W):</span>
                <span class="result-value" id="sheetWidth">-</span>
            </div>
            <div class="result-item">
                <span class="result-label">Area per Carton:</span>
                <span class="result-value" id="areaPerCarton">-</span>
            </div>
            <div class="result-item">
                <span class="result-label">Total Area:</span>
                <span class="result-value" id="totalArea">-</span>
            </div>
            <div class="result-item" id="unitPriceRow" style="display: none;">
                <span class="result-label">Unit Price per Carton:</span>
                <span class="result-value" id="unitPrice">-</span>
            </div>
            <div class="result-item" id="totalPriceRow" style="display: none;">
                <span class="result-label">Total Price (LC Price):</span>
                <span class="result-value" id="totalPrice">-</span>
            </div>

            <div class="result-item" id="markingPriceRow" style="display: none;">
                <span class="result-label">Price with Carton Marking:</span>
                <span class="result-value" id="markingPrice">-</span>
            </div>

            <div class="result-item" id="rebateRow" style="display: none;">
                <span class="result-label" id="rebateLabel">Rebates for Matalan:</span>
                <span class="result-value" id="rebate">-</span>
            </div>
            <div class="result-item" id="pacdRow" style="display: none;">
                <span class="result-label" id="pacdLabel">For PacD:</span>
                <span class="result-value" id="pacd">-</span>
            </div>
            <div class="result-item" id="supplierPriceRow" style="display: none;">
                <span class="result-label">Packaging Supplier Price:</span>
                <span class="result-value" id="supplierPrice">-</span>
            </div>
            
            <div id="customMessage" class="custom-message" style="display: none;">
                Please contact packaging supplier for pricing
            </div>
        </div>
    </div>

    <div class="logo-footer">
        <img src="image_a18ea1.png" alt="Matalan Logo">
        <img src="image_a18ebf.png" alt="PacD Logo">
    </div>

    <script>
        const role = 'admin'; 

        const cartonData = {
            'A1': { L: 495, W: 285, H: 375, unitPrice: 0.97 },
            'A2': { L: 495, W: 285, H: 310, unitPrice: 0.88 },
            'A3': { L: 495, W: 285, H: 260, unitPrice: 0.81 },
            'B1': { L: 595, W: 285, H: 375, unitPrice: 1.10 },
            'B2': { L: 595, W: 285, H: 310, unitPrice: 0.99 },
            'B3': { L: 595, W: 285, H: 260, unitPrice: 0.90 },
            'C1': { L: 595, W: 325, H: 375, unitPrice: 1.22 },
            'C2': { L: 595, W: 325, H: 310, unitPrice: 1.10 },
            'C3': { L: 595, W: 325, H: 260, unitPrice: 1.02 },
            'D1': { L: 595, W: 380, H: 375, unitPrice: 1.39 },
            'D2': { L: 595, W: 380, H: 310, unitPrice: 1.27 },
            'D3': { L: 595, W: 380, H: 260, unitPrice: 1.18 },
            'R-FPA': { L: 495, W: 285, H: null, unitPrice: 1.03 },
            'R-FPB': { L: 595, W: 285, H: null, unitPrice: 1.03 },
            'R-FPC': { L: 595, W: 325, H: null, unitPrice: 1.03 },
            'R-FPD': { L: 595, W: 380, H: null, unitPrice: 1.03 }
        };

        const allResultRows = [
            'sheetLengthRow', 'sheetWidthRow', 'unitPriceRow', 'totalPriceRow',
            'markingPriceRow', 'rebateRow', 'pacdRow', 'supplierPriceRow'
        ];

        function clearDimensions() {
            document.getElementById('length').value = '';
            document.getElementById('width').value = '';
            document.getElementById('height').value = '';
            document.getElementById('length').disabled = true;
            document.getElementById('width').disabled = true;
            document.getElementById('height').disabled = true;
        }

        function checkQuantity() {
            const qty = parseFloat(document.getElementById('quantity').value);
            const markingSection = document.getElementById('markingSection');
            
            if (qty && qty < 100) {
                markingSection.style.display = 'block';
            } else {
                markingSection.style.display = 'none';
            }
        }

        function updateCartonStyle() {
            const flute = document.getElementById('flute').value;
            const cartonStyleSelect = document.getElementById('cartonStyle');
            const cartonSelectionSelect = document.getElementById('cartonSelection');
            
            cartonStyleSelect.innerHTML = '<option value="">Select Carton Style</option>';
            cartonSelectionSelect.innerHTML = '<option value="">Select Carton</option>';
            cartonSelectionSelect.disabled = true;
            
            clearDimensions();
            document.getElementById('results').classList.remove('show');
            
            if (flute === 'bc-flute') {
                cartonStyleSelect.innerHTML += '<option value="standard">Standard Carton - Singles</option>';
                cartonStyleSelect.innerHTML += '<option value="custom">Custom Carton</option>';
                cartonStyleSelect.disabled = false;
            } else if (flute === 'c-flute') {
                cartonStyleSelect.innerHTML += '<option value="ratio">Ratio Carton</option>';
                cartonStyleSelect.innerHTML += '<option value="custom">Custom Carton</option>';
                cartonStyleSelect.disabled = false;
            } else {
                cartonStyleSelect.disabled = true;
            }
        }

        function updateCartonSelection() {
            const cartonStyle = document.getElementById('cartonStyle').value;
            const cartonSelectionSelect = document.getElementById('cartonSelection');
            
            cartonSelectionSelect.innerHTML = '<option value="">Select Carton</option>';
            cartonSelectionSelect.disabled = true;
            clearDimensions();

            document.getElementById('results').classList.remove('show');
            
            if (cartonStyle === 'standard') {
                const options = ['A1', 'A2', 'A3', 'B1', 'B2', 'B3', 'C1', 'C2', 'C3', 'D1', 'D2', 'D3'];
                options.forEach(opt => {
                    const data = cartonData[opt];
                    const display = `${opt} (${data.L} x ${data.W} x ${data.H} mm)`;
                    cartonSelectionSelect.innerHTML += `<option value="${opt}">${display}</option>`;
                });
                cartonSelectionSelect.disabled = false;
            } else if (cartonStyle === 'ratio') {
                const options = ['R-FPA', 'R-FPB', 'R-FPC', 'R-FPD'];
                options.forEach(opt => {
                    const data = cartonData[opt];
                    const display = `${opt} (${data.L} x ${data.W} mm)`;
                    cartonSelectionSelect.innerHTML += `<option value="${opt}">${display}</option>`;
                });
                cartonSelectionSelect.disabled = false;
            } else if (cartonStyle === 'custom') {
                cartonSelectionSelect.innerHTML += '<option value="custom">Custom Carton (Enter dimensions below)</option>';
                cartonSelectionSelect.disabled = false;
                cartonSelectionSelect.value = 'custom';
                updateDimensions();
            }
        }

        function updateDimensions() {
            const selection = document.getElementById('cartonSelection').value;
            const lengthInput = document.getElementById('length');
            const widthInput = document.getElementById('width');
            const heightInput = document.getElementById('height');
            
            lengthInput.value = '';
            widthInput.value = '';
            heightInput.value = '';
            
            if (selection === 'custom') {
                lengthInput.disabled = false;
                widthInput.disabled = false;
                heightInput.disabled = false;
            } else if (selection && cartonData[selection]) {
                const data = cartonData[selection];
                lengthInput.value = data.L || '';
                widthInput.value = data.W || '';
                heightInput.value = data.H || '';
                
                const isRatioCarton = selection.startsWith('R-');
                
                if (isRatioCarton) {
                    lengthInput.disabled = true;
                    widthInput.disabled = true;
                    heightInput.disabled = false;
                } else {
                    lengthInput.disabled = true;
                    widthInput.disabled = true;
                    heightInput.disabled = true;
                }
            } else {
                lengthInput.disabled = true;
                widthInput.disabled = true;
                heightInput.disabled = true;
            }
            
            document.getElementById('results').classList.remove('show');
        }

        function calculate() {
            const flute = document.getElementById('flute').value;
            const cartonStyle = document.getElementById('cartonStyle').value;
            const selection = document.getElementById('cartonSelection').value;
            const length = parseFloat(document.getElementById('length').value);
            const width = parseFloat(document.getElementById('width').value);
            const height = parseFloat(document.getElementById('height').value);
            const quantity = parseFloat(document.getElementById('quantity').value);
            
            if (!flute || !selection || !length || !width || !height || !quantity || quantity <= 0) {
                alert('Please fill in all dimensions, select flute/carton, and enter a valid quantity.');
                return;
            }

            checkQuantity();
            
            let L, W, areaPerCarton;

            if (flute === 'bc-flute') {
                L = (length + width) * 2 + 11;
                W = (height + width) - 16;
                areaPerCarton = (L * W) / 1000000;
                
                if (cartonStyle === 'custom') {
                    areaPerCarton = areaPerCarton * 1.1;
                }
            } else if (flute === 'c-flute') {
                L = (length + width) * 2 + 15;
                W = (width + height) - 10;
                areaPerCarton = (L * W * 1.025) / 1000000;
            } else {
                alert('Invalid Flute Type selected.');
                return;
            }
            
            const totalArea = areaPerCarton * quantity;
            
            document.getElementById('sheetLength').textContent = L.toFixed(2) + ' mm';
            document.getElementById('sheetWidth').textContent = W.toFixed(2) + ' mm';
            document.getElementById('areaPerCarton').textContent = areaPerCarton.toFixed(6) + ' m²';
            document.getElementById('totalArea').textContent = totalArea.toFixed(6) + ' m²';

            allResultRows.forEach(id => {
                const element = document.getElementById(id);
                if (element) element.style.display = 'none';
            });
            document.getElementById('customMessage').style.display = 'none';

            const isCustom = selection === 'custom';
            
            if (!isCustom) {
                const priceValue = cartonData[selection].unitPrice;
                let totalPrice;
                
                if (flute === 'bc-flute') {
                    totalPrice = quantity * priceValue;
                    document.getElementById('unitPrice').textContent = '$' + priceValue.toFixed(2);
                    document.getElementById('unitPriceRow').querySelector('.result-label').textContent = 'Unit Price:';
                } else if (flute === 'c-flute') {
                    totalPrice = totalArea * priceValue ;
                    document.getElementById('unitPrice').textContent = '$' + priceValue.toFixed(2);
                    document.getElementById('unitPriceRow').querySelector('.result-label').textContent = 'SQM Price:';
                }
                
                const rebatePercent = flute === 'bc-flute' ? 0.05 : 0.10;
                const rebate = totalPrice * rebatePercent;
                
                const pacdPercent = flute === 'bc-flute' ? 0.04 : 0.075;
                const pacd = (totalPrice - rebate) * pacdPercent;
                
                // Calculate marking cost FIRST
                let markingCost = 0;
                if (quantity < 100) {
                    const markingType = document.querySelector('input[name="marking"]:checked').value;
                    
                    if (markingType === 'print') {
                        markingCost = 20.00; 
                    } else if (markingType === 'label') {
                        markingCost = quantity * 0.06;
                    }
                }

                // THEN calculate supplier price
                const supplierPrice = totalPrice - rebate - pacd + markingCost;

                // Update labels
                document.getElementById('rebateLabel').textContent = `Rebates for Matalan (${rebatePercent * 100}%):`;
                document.getElementById('pacdLabel').textContent = `For PacD (${pacdPercent * 100}%):`;

                // Update all price displays
                document.getElementById('totalPrice').textContent = '$' + totalPrice.toFixed(2);
                document.getElementById('rebate').textContent = '$' + rebate.toFixed(2);
                document.getElementById('pacd').textContent = '$' + pacd.toFixed(2);
                document.getElementById('supplierPrice').textContent = '$' + supplierPrice.toFixed(2);
                
                // Handle marking price display
                if (quantity < 100) {
                    const markingType = document.querySelector('input[name="marking"]:checked').value;
                    const priceWithMarking = totalPrice + markingCost;
                    document.getElementById('markingPrice').textContent = '$' + priceWithMarking.toFixed(2);
                    
                    if ((role === 'admin' || role === 'garment_supplier') && markingType !== 'none') {
                        document.getElementById('markingPriceRow').style.display = 'flex';
                    }
                }

                // Show/hide rows based on role
                if (role === 'admin') {
                    document.getElementById('unitPriceRow').style.display = 'flex';
                    document.getElementById('totalPriceRow').style.display = 'flex';
                    document.getElementById('rebateRow').style.display = 'flex';
                    document.getElementById('pacdRow').style.display = 'flex';
                    document.getElementById('supplierPriceRow').style.display = 'flex';
                } else if (role === 'garment_supplier') {
                    document.getElementById('totalPriceRow').style.display = 'flex'; 
                } else if (role === 'packaging_supplier') {
                    document.getElementById('supplierPriceRow').style.display = 'flex';
                }

                document.getElementById('results').children[2].style.display = 'flex';
                document.getElementById('results').children[3].style.display = 'flex';
                
            } else {
                document.getElementById('customMessage').style.display = 'block';
                document.getElementById('results').children[2].style.display = 'flex';
                document.getElementById('results').children[3].style.display = 'flex';
            }
            
            const showSheetDimensions = role === 'admin';
            document.getElementById('sheetLengthRow').style.display = showSheetDimensions ? 'flex' : 'none';
            document.getElementById('sheetWidthRow').style.display = showSheetDimensions ? 'flex' : 'none';
            
            document.getElementById('results').classList.add('show');
        }
    </script>
</body>
</html>